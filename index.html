<!DOCTYPE html>
<html>
<head>
  <title>Supabase Test</title>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

<h2>Login</h2>

<input type="email" id="email" placeholder="Email"><br><br>
<input type="password" id="password" placeholder="Password"><br><br>
<button onclick="login()">Login</button>

<hr>

<div id="dashboard" style="display:none;">
  <h2>Dashboard</h2>
  <p>Task Count: <span id="count">0</span></p>
  <button onclick="logout()">Logout</button>
</div>

<script>
  const SUPABASE_URL = "https://cyasrzixhiysznsbssgm.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN5YXNyeml4aGl5c3puc2Jzc2dtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA5NzQyODAsImV4cCI6MjA4NjU1MDI4MH0.l351mEgutamqauI8hb1qDsaRbpecv2Pd14noR4HpZyU";

  const supabaseClient = supabase.createClient(
    SUPABASE_URL,
    SUPABASE_ANON_KEY
  );

  async function login() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    const { error } = await supabaseClient.auth.signInWithPassword({
      email,
      password
    });

    if (error) {
      alert(error.message);
    }
  }

  async function logout() {
    await supabaseClient.auth.signOut();
  }

  supabaseClient.auth.onAuthStateChange((event, session) => {

    if (session) {
      document.getElementById("dashboard").style.display = "block";
      loadTasks(session.user.id);
    } else {
      document.getElementById("dashboard").style.display = "none";
    }

  });

  async function loadTasks(userId) {

    const { count } = await supabaseClient
      .from("tasks")
      .select("*", { count: "exact" })
      .eq("user_id", userId);

    document.getElementById("count").textContent = count || 0;
  }

</script>

</body>
</html>                        </div>
                    </div>
                    <div id="reminders-list"></div>
                </div>

                <div class="card" style="padding: 18px;">
                    <div class="card-title"><i data-lucide="users" size="16"></i> Active Peers</div>
                    <div id="users-list">
                        <p style="font-size: 0.8rem; color: var(--text-muted)">Connecting...</p>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main>
                <div class="card">
                    <div class="card-title"><i data-lucide="plus-square" size="16"></i> New Mission</div>
                    <form id="shared-task-form" class="task-form">
                        <div style="display: grid; grid-template-columns: 1.5fr 1fr 1fr; gap: 10px;">
                            <input type="text" id="m-name" placeholder="Title..." required>
                            <select id="m-subject" required>
                                <option value="" disabled selected>Subject</option>
                                <option>Maths</option><option>Physics</option><option>ITKS</option>
                                <option>COA</option><option>DS</option><option>OOP</option><option>LLC</option>
                            </select>
                            <input type="date" id="m-date" required>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1.5fr auto; gap: 10px;">
                            <select id="m-category" required>
                                <option value="" disabled>Format</option>
                                <option value="Assignment" selected>Assignment</option>
                                <option value="Project">Project</option>
                                <option value="Exam">Exam</option>
                                <option value="Test">Test</option>
                                <option value="Self Study">Self Study</option>
                            </select>
                            <input type="url" id="m-file-url" placeholder="Resource Link (Optional)">
                            <button type="submit" class="btn-primary" style="width: auto;">Post to Ledger</button>
                        </div>
                    </form>
                </div>

                <div class="card">
                    <div class="card-title"><i data-lucide="database" size="16"></i> Global Ledger</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Mission</th>
                                    <th>Subject</th>
                                    <th>Deadline</th>
                                    <th>Details</th>
                                    <th>Author</th>
                                    <th width="40"></th>
                                </tr>
                            </thead>
                            <tbody id="shared-tasks-list"></tbody>
                        </table>
                        <div id="empty-state" style="display:none; text-align: center; padding: 40px;">
                            <p style="color: var(--text-muted); font-weight: 600; font-size: 0.9rem;">No active missions found in the nexus.</p>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/supabaseClient.js"></script>
<script src="js/supabaseClient.js"></script>
<script src="js/app.js"></script>


</body>

</html>

